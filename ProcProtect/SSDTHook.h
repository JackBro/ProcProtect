#ifndef _SSDT_HOOK_H
#define _SSDT_HOOK_H

#include <WinDef.h>

// 目标系统版本可用的有:
// WinVer_XP_SP2
// WinVer_XP_SP3
#define WinVer_XP_SP3

#define MAX_SSDT_ITEM_NUM 1024
#define SSDTSHADOW_MAX_SEARCH_LENGTH 0x100

// NtUserQueryWindow DWORD Index
#define QUERY_WINDOW_UNIQUE_PROCESS_ID	0x00
#define QUERY_WINDOW_UNIQUE_THREAD_ID	0x01
#define QUERY_WINDOW_ACTIVE				0x02
#define QUERY_WINDOW_FOCUS				0x03
#define QUERY_WINDOW_ISHUNG				0x04
#define QUERY_WINDOW_REAL_ID			0x05


#ifdef WinVer_XP_SP2
// SSDT函数表
enum SSDTFuncNum{
	nt_NtAcceptConnectPort,
	nt_NtAccessCheck,
	nt_NtAccessCheckAndAuditAlarm,
	nt_NtAccessCheckByType,
	nt_NtAccessCheckByTypeAndAuditAlarm,
	nt_NtAccessCheckByTypeResultList,
	nt_NtAccessCheckByTypeResultListAndAuditAlarm,
	nt_NtAccessCheckByTypeResultListAndAuditAlarmByHandle,
	nt_NtAddAtom,
	nt_NtSetBootOptions,
	nt_NtAdjustGroupsToken,
	nt_NtAdjustPrivilegesToken,
	nt_NtAlertResumeThread,
	nt_NtAlertThread,
	nt_NtAllocateLocallyUniqueId,
	nt_NtAllocateUserPhysicalPages,
	nt_NtAllocateUuids,
	nt_NtAllocateVirtualMemory,
	nt_NtAreMappedFilesTheSame,
	nt_NtAssignProcessToJobObject,
	nt_NtCallbackReturn,
	nt_NtDeleteBootEntry,
	nt_NtCancelIoFile,
	nt_NtCancelTimer,
	nt_NtClearEvent,
	nt_NtClose,
	nt_NtCloseObjectAuditAlarm,
	nt_NtCompactKeys,
	nt_NtCompareTokens,
	nt_NtCompleteConnectPort,
	nt_NtCompressKey,
	nt_NtConnectPort,
	nt_NtContinue,
	nt_NtCreateDebugObject,
	nt_NtCreateDirectoryObject,
	nt_NtCreateEvent,
	nt_NtCreateEventPair,
	nt_NtCreateFile,
	nt_NtCreateIoCompletion,
	nt_NtCreateJobObject,
	nt_NtCreateJobSet,
	nt_NtCreateKey,
	nt_NtCreateMailslotFile,
	nt_NtCreateMutant,
	nt_NtCreateNamedPipeFile,
	nt_NtCreatePagingFile,
	nt_NtCreatePort,
	nt_NtCreateProcess,
	nt_NtCreateProcessEx,
	nt_NtCreateProfile,
	nt_NtCreateSection,
	nt_NtCreateSemaphore,
	nt_NtCreateSymbolicLinkObject,
	nt_NtCreateThread,
	nt_NtCreateTimer,
	nt_NtCreateToken,
	nt_NtCreateWaitablePort,
	nt_NtDebugActiveProcess,
	nt_NtDebugContinue,
	nt_NtDelayExecution,
	nt_NtDeleteAtom,
	nt_NtDeleteBootEntry1,
	nt_NtDeleteFile,
	nt_NtDeleteKey,
	nt_NtDeleteObjectAuditAlarm,
	nt_NtDeleteValueKey,
	nt_NtDeviceIoControlFile,
	nt_NtDisplayString,
	nt_NtDuplicateObject,
	nt_NtDuplicateToken,
	nt_NtSetBootOptions1,
	nt_NtEnumerateKey,
	nt_NtEnumerateSystemEnvironmentValuesEx,
	nt_NtEnumerateValueKey,
	nt_NtExtendSection,
	nt_NtFilterToken,
	nt_NtFindAtom,
	nt_NtFlushBuffersFile,
	nt_NtFlushInstructionCache,
	nt_NtFlushKey,
	nt_NtFlushVirtualMemory,
	nt_NtFlushWriteBuffer,
	nt_NtFreeUserPhysicalPages,
	nt_NtFreeVirtualMemory,
	nt_NtFsControlFile,
	nt_NtGetContextThread,
	nt_NtGetDevicePowerState,
	nt_NtGetPlugPlayEvent,
	nt_NtGetWriteWatch,
	nt_NtImpersonateAnonymousToken,
	nt_NtImpersonateClientOfPort,
	nt_NtImpersonateThread,
	nt_NtInitializeRegistry,
	nt_NtInitiatePowerAction,
	nt_NtIsProcessInJob,
	nt_NtIsSystemResumeAutomatic,
	nt_NtListenPort,
	nt_NtLoadDriver,
	nt_NtLoadKey,
	nt_NtLoadKey2,
	nt_NtLockFile,
	nt_NtLockProductActivationKeys,
	nt_NtLockRegistryKey,
	nt_NtLockVirtualMemory,
	nt_NtMakePermanentObject,
	nt_NtMakeTemporaryObject,
	nt_NtMapUserPhysicalPages,
	nt_NtMapUserPhysicalPagesScatter,
	nt_NtMapViewOfSection,
	nt_NtDeleteBootEntry2,
	nt_NtNotifyChangeDirectoryFile,
	nt_NtNotifyChangeKey,
	nt_NtNotifyChangeMultipleKeys,
	nt_NtOpenDirectoryObject,
	nt_NtOpenEvent,
	nt_NtOpenEventPair,
	nt_NtOpenFile,
	nt_NtOpenIoCompletion,
	nt_NtOpenJobObject,
	nt_NtOpenKey,
	nt_NtOpenMutant,
	nt_NtOpenObjectAuditAlarm,
	nt_NtOpenProcess,
	nt_NtOpenProcessToken,
	nt_NtOpenProcessTokenEx,
	nt_NtOpenSection,
	nt_NtOpenSemaphore,
	nt_NtOpenSymbolicLinkObject,
	nt_NtOpenThread,
	nt_NtOpenThreadToken,
	nt_NtOpenThreadTokenEx,
	nt_NtOpenTimer,
	nt_NtPlugPlayControl,
	nt_NtPowerInformation,
	nt_NtPrivilegeCheck,
	nt_NtPrivilegeObjectAuditAlarm,
	nt_NtPrivilegedServiceAuditAlarm,
	nt_NtProtectVirtualMemory,
	nt_NtPulseEvent,
	nt_NtQueryAttributesFile,
	nt_NtSetBootOptions2,
	nt_NtSetBootOptions3,
	nt_NtQueryDebugFilterState,
	nt_NtQueryDefaultLocale,
	nt_NtQueryDefaultUILanguage,
	nt_NtQueryDirectoryFile,
	nt_NtQueryDirectoryObject,
	nt_NtQueryEaFile,
	nt_NtQueryEvent,
	nt_NtQueryFullAttributesFile,
	nt_NtQueryInformationAtom,
	nt_NtQueryInformationFile,
	nt_NtQueryInformationJobObject,
	nt_NtQueryInformationPort,
	nt_NtQueryInformationProcess,
	nt_NtQueryInformationThread,
	nt_NtQueryInformationToken,
	nt_NtQueryInstallUILanguage,
	nt_NtQueryIntervalProfile,
	nt_NtQueryIoCompletion,
	nt_NtQueryKey,
	nt_NtQueryMultipleValueKey,
	nt_NtQueryMutant,
	nt_NtQueryObject,
	nt_NtQueryOpenSubKeys,
	nt_NtQueryPerformanceCounter,
	nt_NtQueryQuotaInformationFile,
	nt_NtQuerySection,
	nt_NtQuerySecurityObject,
	nt_NtQuerySemaphore,
	nt_NtQuerySymbolicLinkObject,
	nt_NtQuerySystemEnvironmentValue,
	nt_NtSetSystemEnvironmentValueEx,
	nt_NtQuerySystemInformation,
	nt_NtQuerySystemTime,
	nt_NtQueryTimer,
	nt_NtQueryTimerResolution,
	nt_NtQueryValueKey,
	nt_NtQueryVirtualMemory,
	nt_NtQueryVolumeInformationFile,
	nt_NtQueueApcThread,
	nt_NtRaiseException,
	nt_NtRaiseHardError,
	nt_NtReadFile,
	nt_NtReadFileScatter,
	nt_NtReadRequestData,
	nt_NtReadVirtualMemory,
	nt_NtRegisterThreadTerminatePort,
	nt_NtReleaseMutant,
	nt_NtReleaseSemaphore,
	nt_NtRemoveIoCompletion,
	nt_NtRemoveProcessDebug,
	nt_NtRenameKey,
	nt_NtReplaceKey,
	nt_NtReplyPort,
	nt_NtReplyWaitReceivePort,
	nt_NtReplyWaitReceivePortEx,
	nt_NtReplyWaitReplyPort,
	nt_NtRequestDeviceWakeup,
	nt_NtRequestPort,
	nt_NtRequestWaitReplyPort,
	nt_NtRequestWakeupLatency,
	nt_NtResetEvent,
	nt_NtResetWriteWatch,
	nt_NtRestoreKey,
	nt_NtResumeProcess,
	nt_NtResumeThread,
	nt_NtSaveKey,
	nt_NtSaveKeyEx,
	nt_NtSaveMergedKeys,
	nt_NtSecureConnectPort,
	nt_NtSetBootOptions4,
	nt_NtSetBootOptions5,
	nt_NtSetContextThread,
	nt_NtSetDebugFilterState,
	nt_NtSetDefaultHardErrorPort,
	nt_NtSetDefaultLocale,
	nt_NtSetDefaultUILanguage,
	nt_NtSetEaFile,
	nt_NtSetEvent,
	nt_NtSetEventBoostPriority,
	nt_NtSetHighEventPair,
	nt_NtSetHighWaitLowEventPair,
	nt_NtSetInformationDebugObject,
	nt_NtSetInformationFile,
	nt_NtSetInformationJobObject,
	nt_NtSetInformationKey,
	nt_NtSetInformationObject,
	nt_NtSetInformationProcess,
	nt_NtSetInformationThread,
	nt_NtSetInformationToken,
	nt_NtSetIntervalProfile,
	nt_NtSetIoCompletion,
	nt_NtSetLdtEntries,
	nt_NtSetLowEventPair,
	nt_NtSetLowWaitHighEventPair,
	nt_NtSetQuotaInformationFile,
	nt_NtSetSecurityObject,
	nt_NtSetSystemEnvironmentValue,
	nt_NtSetSystemEnvironmentValueEx1,
	nt_NtSetSystemInformation,
	nt_NtSetSystemPowerState,
	nt_NtSetSystemTime,
	nt_NtSetThreadExecutionState,
	nt_NtSetTimer,
	nt_NtSetTimerResolution,
	nt_NtSetUuidSeed,
	nt_NtSetValueKey,
	nt_NtSetVolumeInformationFile,
	nt_NtShutdownSystem,
	nt_NtSignalAndWaitForSingleObject,
	nt_NtStartProfile,
	nt_NtStopProfile,
	nt_NtSuspendProcess,
	nt_NtSuspendThread,
	nt_NtSystemDebugControl,
	nt_NtTerminateJobObject,
	nt_NtTerminateProcess,
	nt_NtTerminateThread,
	nt_NtTestAlert,
	nt_NtTraceEvent,
	nt_NtTranslateFilePath,
	nt_NtUnloadDriver,
	nt_NtUnloadKey,
	nt_NtUnloadKeyEx,
	nt_NtUnlockFile,
	nt_NtUnlockVirtualMemory,
	nt_NtUnmapViewOfSection,
	nt_NtVdmControl,
	nt_NtWaitForDebugEvent,
	nt_NtWaitForMultipleObjects,
	nt_NtWaitForSingleObject,
	nt_NtWaitHighEventPair,
	nt_NtWaitLowEventPair,
	nt_NtWriteFile,
	nt_NtWriteFileGather,
	nt_NtWriteRequestData,
	nt_NtWriteVirtualMemory,
	nt_NtYieldExecution,
	nt_NtCreateKeyedEvent,
	nt_NtOpenKeyedEvent,
	nt_NtReleaseKeyedEvent,
	nt_NtWaitForKeyedEvent,
	nt_NtQueryPortInformationProcess
};

// SSDTShadow函数表
enum SSDTShadowFuncNum
{
	win32k_NtGdiAbortDoc,
	win32k_NtGdiAbortPath,
	win32k_NtGdiAddFontResourceW,
	win32k_NtGdiAddRemoteFontToDC,
	win32k_NtGdiAddFontMemResourceEx,
	win32k_NtGdiRemoveMergeFont,
	win32k_NtGdiAddRemoteMMInstanceToDC,
	win32k_NtGdiAlphaBlend,
	win32k_NtGdiAngleArc,
	win32k_NtGdiAnyLinkedFonts,
	win32k_NtGdiFontIsLinked,
	win32k_NtGdiArcInternal,
	win32k_NtGdiBeginPath,
	win32k_NtGdiBitBlt,
	win32k_NtGdiCancelDC,
	win32k_NtGdiCheckBitmapBits,
	win32k_NtGdiCloseFigure,
	win32k_NtGdiClearBitmapAttributes,
	win32k_NtGdiClearBrushAttributes,
	win32k_NtGdiColorCorrectPalette,
	win32k_NtGdiCombineRgn,
	win32k_NtGdiCombineTransform,
	win32k_NtGdiComputeXformCoefficients,
	win32k_NtGdiConsoleTextOut,
	win32k_NtGdiConvertMetafileRect,
	win32k_NtGdiCreateBitmap,
	win32k_NtGdiCreateClientObj,
	win32k_NtGdiCreateColorSpace,
	win32k_NtGdiCreateColorTransform,
	win32k_NtGdiCreateCompatibleBitmap,
	win32k_NtGdiCreateCompatibleDC,
	win32k_NtGdiCreateDIBBrush,
	win32k_NtGdiCreateDIBitmapInternal,
	win32k_NtGdiCreateDIBSection,
	win32k_NtGdiCreateEllipticRgn,
	win32k_NtGdiCreateHalftonePalette,
	win32k_NtGdiCreateHatchBrushInternal,
	win32k_NtGdiCreateMetafileDC,
	win32k_NtGdiCreatePaletteInternal,
	win32k_NtGdiCreatePatternBrushInternal,
	win32k_NtGdiCreatePen,
	win32k_NtGdiCreateRectRgn,
	win32k_NtGdiCreateRoundRectRgn,
	win32k_NtGdiCreateServerMetaFile,
	win32k_NtGdiCreateSolidBrush,
	win32k_NtGdiD3dContextCreate,
	win32k_NtGdiD3dContextDestroy,
	win32k_NtGdiD3dContextDestroyAll,
	win32k_NtGdiD3dValidateTextureStageState,
	win32k_NtGdiD3dDrawPrimitives2,
	win32k_NtGdiDdGetDriverState,
	win32k_NtGdiDdAddAttachedSurface,
	win32k_NtGdiDdAlphaBlt,
	win32k_NtGdiDdAttachSurface,
	win32k_NtGdiDdBeginMoCompFrame,
	win32k_NtGdiDdBlt,
	win32k_NtGdiDdCanCreateSurface,
	win32k_NtGdiDdCanCreateD3DBuffer,
	win32k_NtGdiDdColorControl,
	win32k_NtGdiDdCreateDirectDrawObject,
	win32k_NtGdiDdCreateSurface,
	win32k_NtGdiDdCreateD3DBuffer,
	win32k_NtGdiDdCreateMoComp,
	win32k_NtGdiDdCreateSurfaceObject,
	win32k_NtGdiDdDeleteDirectDrawObject,
	win32k_NtGdiDdDeleteSurfaceObject,
	win32k_NtGdiDdDestroyMoComp,
	win32k_NtGdiDdDestroySurface,
	win32k_NtGdiDdDestroyD3DBuffer,
	win32k_NtGdiDdEndMoCompFrame,
	win32k_NtGdiDdFlip,
	win32k_NtGdiDdFlipToGDISurface,
	win32k_NtGdiDdGetAvailDriverMemory,
	win32k_NtGdiDdGetBltStatus,
	win32k_NtGdiDdGetDC,
	win32k_NtGdiDdGetDriverInfo,
	win32k_NtGdiDdGetDxHandle,
	win32k_NtGdiDdGetFlipStatus,
	win32k_NtGdiDdGetInternalMoCompInfo,
	win32k_NtGdiDdGetMoCompBuffInfo,
	win32k_NtGdiDdGetMoCompGuids,
	win32k_NtGdiDdGetMoCompFormats,
	win32k_NtGdiDdGetScanLine,
	win32k_NtGdiDdLock,
	win32k_NtGdiDdLockD3D,
	win32k_NtGdiDdQueryDirectDrawObject,
	win32k_NtGdiDdQueryMoCompStatus,
	win32k_NtGdiDdReenableDirectDrawObject,
	win32k_NtGdiDdReleaseDC,
	win32k_NtGdiDdRenderMoComp,
	win32k_NtGdiDdResetVisrgn,
	win32k_NtGdiDdSetColorKey,
	win32k_NtGdiDdSetExclusiveMode,
	win32k_NtGdiDdSetGammaRamp,
	win32k_NtGdiDdCreateSurfaceEx,
	win32k_NtGdiDdSetOverlayPosition,
	win32k_NtGdiDdUnattachSurface,
	win32k_NtGdiDdUnlock,
	win32k_NtGdiDdUnlockD3D,
	win32k_NtGdiDdUpdateOverlay,
	win32k_NtGdiDdWaitForVerticalBlank,
	win32k_NtGdiDvpCanCreateVideoPort,
	win32k_NtGdiDvpColorControl,
	win32k_NtGdiDvpCreateVideoPort,
	win32k_NtGdiDvpDestroyVideoPort,
	win32k_NtGdiDvpFlipVideoPort,
	win32k_NtGdiDvpGetVideoPortBandwidth,
	win32k_NtGdiDvpGetVideoPortField,
	win32k_NtGdiDvpGetVideoPortFlipStatus,
	win32k_NtGdiDvpGetVideoPortInputFormats,
	win32k_NtGdiDvpGetVideoPortLine,
	win32k_NtGdiDvpGetVideoPortOutputFormats,
	win32k_NtGdiDvpGetVideoPortConnectInfo,
	win32k_NtGdiDvpGetVideoSignalStatus,
	win32k_NtGdiDvpUpdateVideoPort,
	win32k_NtGdiDvpWaitForVideoPortSync,
	win32k_NtGdiDvpAcquireNotification,
	win32k_NtGdiDvpReleaseNotification,
	win32k_NtGdiDxgGenericThunk,
	win32k_NtGdiDeleteClientObj,
	win32k_NtGdiDeleteColorSpace,
	win32k_NtGdiDeleteColorTransform,
	win32k_NtGdiDeleteObjectApp,
	win32k_NtGdiDescribePixelFormat,
	win32k_NtGdiGetPerBandInfo,
	win32k_NtGdiDoBanding,
	win32k_NtGdiDoPalette,
	win32k_NtGdiDrawEscape,
	win32k_NtGdiEllipse,
	win32k_NtGdiEnableEudc,
	win32k_NtGdiEndDoc,
	win32k_NtGdiEndPage,
	win32k_NtGdiEndPath,
	win32k_NtGdiEnumFontChunk,
	win32k_NtGdiEnumFontClose,
	win32k_NtGdiEnumFontOpen,
	win32k_NtGdiEnumObjects,
	win32k_NtGdiEqualRgn,
	win32k_NtGdiEudcLoadUnloadLink,
	win32k_NtGdiExcludeClipRect,
	win32k_NtGdiExtCreatePen,
	win32k_NtGdiExtCreateRegion,
	win32k_NtGdiExtEscape,
	win32k_NtGdiExtFloodFill,
	win32k_NtGdiExtGetObjectW,
	win32k_NtGdiExtSelectClipRgn,
	win32k_NtGdiExtTextOutW,
	win32k_NtGdiFillPath,
	win32k_NtGdiFillRgn,
	win32k_NtGdiFlattenPath,
	win32k_NtGdiFlushUserBatch,
	win32k_NtGdiFlush,
	win32k_NtGdiForceUFIMapping,
	win32k_NtGdiFrameRgn,
	win32k_NtGdiFullscreenControl,
	win32k_NtGdiGetAndSetDCDword,
	win32k_NtGdiGetAppClipBox,
	win32k_NtGdiGetBitmapBits,
	win32k_NtGdiGetBitmapDimension,
	win32k_NtGdiGetBoundsRect,
	win32k_NtGdiGetCharABCWidthsW,
	win32k_NtGdiGetCharacterPlacementW,
	win32k_NtGdiGetCharSet,
	win32k_NtGdiGetCharWidthW,
	win32k_NtGdiGetCharWidthInfo,
	win32k_NtGdiGetColorAdjustment,
	win32k_NtGdiGetColorSpaceforBitmap,
	win32k_NtGdiGetDCDword,
	win32k_NtGdiGetDCforBitmap,
	win32k_NtGdiGetDCObject,
	win32k_NtGdiGetDCPoint,
	win32k_NtGdiGetDeviceCaps,
	win32k_NtGdiGetDeviceGammaRamp,
	win32k_NtGdiGetDeviceCapsAll,
	win32k_NtGdiGetDIBitsInternal,
	win32k_NtGdiGetETM,
	win32k_NtGdiGetEudcTimeStampEx,
	win32k_NtGdiGetFontData,
	win32k_NtGdiGetFontResourceInfoInternalW,
	win32k_NtGdiGetGlyphIndicesW,
	win32k_NtGdiGetGlyphIndicesWInternal,
	win32k_NtGdiGetGlyphOutline,
	win32k_NtGdiGetKerningPairs,
	win32k_NtGdiGetLinkedUFIs,
	win32k_NtGdiGetMiterLimit,
	win32k_NtGdiGetMonitorID,
	win32k_NtGdiGetNearestColor,
	win32k_NtGdiGetNearestPaletteIndex,
	win32k_NtGdiGetObjectBitmapHandle,
	win32k_NtGdiGetOutlineTextMetricsInternalW,
	win32k_NtGdiGetPath,
	win32k_NtGdiGetPixel,
	win32k_NtGdiGetRandomRgn,
	win32k_NtGdiGetRasterizerCaps,
	win32k_NtGdiGetRealizationInfo,
	win32k_NtGdiGetRegionData,
	win32k_NtGdiGetRgnBox,
	win32k_NtGdiGetServerMetaFileBits,
	win32k_NtGdiGetSpoolMessage,
	win32k_NtGdiGetStats,
	win32k_NtGdiGetStockObject,
	win32k_NtGdiGetStringBitmapW,
	win32k_NtGdiGetSystemPaletteUse,
	win32k_NtGdiGetTextCharsetInfo,
	win32k_NtGdiGetTextExtent,
	win32k_NtGdiGetTextExtentExW,
	win32k_NtGdiGetTextFaceW,
	win32k_NtGdiGetTextMetricsW,
	win32k_NtGdiGetTransform,
	win32k_NtGdiGetUFI,
	win32k_NtGdiGetEmbUFI,
	win32k_NtGdiGetUFIPathname,
	win32k_NtGdiGetEmbedFonts,
	win32k_NtGdiChangeGhostFont,
	win32k_NtGdiAddEmbFontToDC,
	win32k_NtGdiGetFontUnicodeRanges,
	win32k_NtGdiGetWidthTable,
	win32k_NtGdiGradientFill,
	win32k_NtGdiHfontCreate,
	win32k_NtGdiIcmBrushInfo,
	win32k_NtGdiInit,
	win32k_NtGdiInitSpool,
	win32k_NtGdiIntersectClipRect,
	win32k_NtGdiInvertRgn,
	win32k_NtGdiLineTo,
	win32k_NtGdiMakeFontDir,
	win32k_NtGdiMakeInfoDC,
	win32k_NtGdiMaskBlt,
	win32k_NtGdiModifyWorldTransform,
	win32k_NtGdiMonoBitmap,
	win32k_NtGdiMoveTo,
	win32k_NtGdiOffsetClipRgn,
	win32k_NtGdiOffsetRgn,
	win32k_NtGdiOpenDCW,
	win32k_NtGdiPatBlt,
	win32k_NtGdiPolyPatBlt,
	win32k_NtGdiPathToRegion,
	win32k_NtGdiPlgBlt,
	win32k_NtGdiPolyDraw,
	win32k_NtGdiPolyPolyDraw,
	win32k_NtGdiPolyTextOutW,
	win32k_NtGdiPtInRegion,
	win32k_NtGdiPtVisible,
	win32k_NtGdiQueryFonts,
	win32k_NtGdiQueryFontAssocInfo,
	win32k_NtGdiRectangle,
	win32k_NtGdiRectInRegion,
	win32k_NtGdiRectVisible,
	win32k_NtGdiRemoveFontResourceW,
	win32k_NtGdiRemoveFontMemResourceEx,
	win32k_NtGdiResetDC,
	win32k_NtGdiResizePalette,
	win32k_NtGdiRestoreDC,
	win32k_NtGdiRoundRect,
	win32k_NtGdiSaveDC,
	win32k_NtGdiScaleViewportExtEx,
	win32k_NtGdiScaleWindowExtEx,
	win32k_NtGdiSelectBitmap,
	win32k_NtGdiSelectBrush,
	win32k_NtGdiSelectClipPath,
	win32k_NtGdiSelectFont,
	win32k_NtGdiSelectPen,
	win32k_NtGdiSetBitmapAttributes,
	win32k_NtGdiSetBitmapBits,
	win32k_NtGdiSetBitmapDimension,
	win32k_NtGdiSetBoundsRect,
	win32k_NtGdiSetBrushAttributes,
	win32k_NtGdiSetBrushOrg,
	win32k_NtGdiSetColorAdjustment,
	win32k_NtGdiSetColorSpace,
	win32k_NtGdiSetDeviceGammaRamp,
	win32k_NtGdiSetDIBitsToDeviceInternal,
	win32k_NtGdiSetFontEnumeration,
	win32k_NtGdiSetFontXform,
	win32k_NtGdiSetIcmMode,
	win32k_NtGdiSetLinkedUFIs,
	win32k_NtGdiSetMagicColors,
	win32k_NtGdiSetMetaRgn,
	win32k_NtGdiSetMiterLimit,
	win32k_NtGdiGetDeviceWidth,
	win32k_NtGdiMirrorWindowOrg,
	win32k_NtGdiSetLayout,
	win32k_NtGdiSetPixel,
	win32k_NtGdiSetPixelFormat,
	win32k_NtGdiSetRectRgn,
	win32k_NtGdiSetSystemPaletteUse,
	win32k_NtGdiSetTextJustification,
	win32k_NtGdiSetupPublicCFONT,
	win32k_NtGdiSetVirtualResolution,
	win32k_NtGdiSetSizeDevice,
	win32k_NtGdiStartDoc,
	win32k_NtGdiStartPage,
	win32k_NtGdiStretchBlt,
	win32k_NtGdiStretchDIBitsInternal,
	win32k_NtGdiStrokeAndFillPath,
	win32k_NtGdiStrokePath,
	win32k_NtGdiSwapBuffers,
	win32k_NtGdiTransformPoints,
	win32k_NtGdiTransparentBlt,
	win32k_NtGdiUnloadPrinterDriver,
	win32k_NtGdiUnmapMemFont,
	win32k_NtGdiUnrealizeObject,
	win32k_NtGdiUpdateColors,
	win32k_NtGdiWidenPath,
	win32k_NtUserActivateKeyboardLayout,
	win32k_NtUserAlterWindowStyle,
	win32k_NtUserAssociateInputContext,
	win32k_NtUserAttachThreadInput,
	win32k_NtUserBeginPaint,
	win32k_NtUserBitBltSysBmp,
	win32k_NtUserBlockInput,
	win32k_NtUserBuildHimcList,
	win32k_NtUserBuildHwndList,
	win32k_NtUserBuildNameList,
	win32k_NtUserBuildPropList,
	win32k_NtUserCallHwnd,
	win32k_NtUserCallHwndLock,
	win32k_NtUserCallHwndOpt,
	win32k_NtUserCallHwndParam,
	win32k_NtUserCallHwndParamLock,
	win32k_NtUserCallMsgFilter,
	win32k_NtUserCallNextHookEx,
	win32k_NtUserCallNoParam,
	win32k_NtUserCallOneParam,
	win32k_NtUserCallTwoParam,
	win32k_NtUserChangeClipboardChain,
	win32k_NtUserChangeDisplaySettings,
	win32k_NtUserCheckImeHotKey,
	win32k_NtUserCheckMenuItem,
	win32k_NtUserChildWindowFromPointEx,
	win32k_NtUserClipCursor,
	win32k_NtUserCloseClipboard,
	win32k_NtUserCloseDesktop,
	win32k_NtUserCloseWindowStation,
	win32k_NtUserConsoleControl,
	win32k_NtUserConvertMemHandle,
	win32k_NtUserCopyAcceleratorTable,
	win32k_NtUserCountClipboardFormats,
	win32k_NtUserCreateAcceleratorTable,
	win32k_NtUserCreateCaret,
	win32k_NtUserCreateDesktop,
	win32k_NtUserCreateInputContext,
	win32k_NtUserCreateLocalMemHandle,
	win32k_NtUserCreateWindowEx,
	win32k_NtUserCreateWindowStation,
	win32k_NtUserDdeGetQualityOfService,
	win32k_NtUserDdeInitialize,
	win32k_NtUserDdeSetQualityOfService,
	win32k_NtUserDeferWindowPos,
	win32k_NtUserDefSetText,
	win32k_NtUserDeleteMenu,
	win32k_NtUserDestroyAcceleratorTable,
	win32k_NtUserDestroyCursor,
	win32k_NtUserDestroyInputContext,
	win32k_NtUserDestroyMenu,
	win32k_NtUserDestroyWindow,
	win32k_NtUserDisableThreadIme,
	win32k_NtUserDispatchMessage,
	win32k_NtUserDragDetect,
	win32k_NtUserDragObject,
	win32k_NtUserDrawAnimatedRects,
	win32k_NtUserDrawCaption,
	win32k_NtUserDrawCaptionTemp,
	win32k_NtUserDrawIconEx,
	win32k_NtUserDrawMenuBarTemp,
	win32k_NtUserEmptyClipboard,
	win32k_NtUserEnableMenuItem,
	win32k_NtUserEnableScrollBar,
	win32k_NtUserEndDeferWindowPosEx,
	win32k_NtUserEndMenu,
	win32k_NtUserEndPaint,
	win32k_NtUserEnumDisplayDevices,
	win32k_NtUserEnumDisplayMonitors,
	win32k_NtUserEnumDisplaySettings,
	win32k_NtUserEvent,
	win32k_NtUserExcludeUpdateRgn,
	win32k_NtUserFillWindow,
	win32k_NtUserFindExistingCursorIcon,
	win32k_NtUserFindWindowEx,
	win32k_NtUserFlashWindowEx,
	win32k_NtUserGetAltTabInfo,
	win32k_NtUserGetAncestor,
	win32k_NtUserGetAppImeLevel,
	win32k_NtUserGetAsyncKeyState,
	win32k_NtUserGetAtomName,
	win32k_NtUserGetCaretBlinkTime,
	win32k_NtUserGetCaretPos,
	win32k_NtUserGetClassInfo,
	win32k_NtUserGetClassName,
	win32k_NtUserGetClipboardData,
	win32k_NtUserGetClipboardFormatName,
	win32k_NtUserGetClipboardOwner,
	win32k_NtUserGetClipboardSequenceNumber,
	win32k_NtUserGetClipboardViewer,
	win32k_NtUserGetClipCursor,
	win32k_NtUserGetComboBoxInfo,
	win32k_NtUserGetControlBrush,
	win32k_NtUserGetControlColor,
	win32k_NtUserGetCPD,
	win32k_NtUserGetCursorFrameInfo,
	win32k_NtUserGetCursorInfo,
	win32k_NtUserGetDC,
	win32k_NtUserGetDCEx,
	win32k_NtUserGetDoubleClickTime,
	win32k_NtUserGetForegroundWindow,
	win32k_NtUserGetGuiResources,
	win32k_NtUserGetGUIThreadInfo,
	win32k_NtUserGetIconInfo,
	win32k_NtUserGetIconSize,
	win32k_NtUserGetImeHotKey,
	win32k_NtUserGetImeInfoEx,
	win32k_NtUserGetInternalWindowPos,
	win32k_NtUserGetKeyboardLayoutList,
	win32k_NtUserGetKeyboardLayoutName,
	win32k_NtUserGetKeyboardState,
	win32k_NtUserGetKeyNameText,
	win32k_NtUserGetKeyState,
	win32k_NtUserGetListBoxInfo,
	win32k_NtUserGetMenuBarInfo,
	win32k_NtUserGetMenuIndex,
	win32k_NtUserGetMenuItemRect,
	win32k_NtUserGetMessage,
	win32k_NtUserGetMouseMovePointsEx,
	win32k_NtUserGetObjectInformation,
	win32k_NtUserGetOpenClipboardWindow,
	win32k_NtUserGetPriorityClipboardFormat,
	win32k_NtUserGetProcessWindowStation,
	win32k_NtUserGetRawInputBuffer,
	win32k_NtUserGetRawInputData,
	win32k_NtUserGetRawInputDeviceInfo,
	win32k_NtUserGetRawInputDeviceList,
	win32k_NtUserGetRegisteredRawInputDevices,
	win32k_NtUserGetScrollBarInfo,
	win32k_NtUserGetSystemMenu,
	win32k_NtUserGetThreadDesktop,
	win32k_NtUserGetThreadState,
	win32k_NtUserGetTitleBarInfo,
	win32k_NtUserGetUpdateRect,
	win32k_NtUserGetUpdateRgn,
	win32k_NtUserGetWindowDC,
	win32k_NtUserGetWindowPlacement,
	win32k_NtUserGetWOWClass,
	win32k_NtUserHardErrorControl,
	win32k_NtUserHideCaret,
	win32k_NtUserHiliteMenuItem,
	win32k_NtUserImpersonateDdeClientWindow,
	win32k_NtUserInitialize,
	win32k_NtUserInitializeClientPfnArrays,
	win32k_NtUserInitTask,
	win32k_NtUserInternalGetWindowText,
	win32k_NtUserInvalidateRect,
	win32k_NtUserInvalidateRgn,
	win32k_NtUserIsClipboardFormatAvailable,
	win32k_NtUserKillTimer,
	win32k_NtUserLoadKeyboardLayoutEx,
	win32k_NtUserLockWindowStation,
	win32k_NtUserLockWindowUpdate,
	win32k_NtUserLockWorkStation,
	win32k_NtUserMapVirtualKeyEx,
	win32k_NtUserMenuItemFromPoint,
	win32k_NtUserMessageCall,
	win32k_NtUserMinMaximize,
	win32k_NtUserMNDragLeave,
	win32k_NtUserMNDragOver,
	win32k_NtUserModifyUserStartupInfoFlags,
	win32k_NtUserMoveWindow,
	win32k_NtUserNotifyIMEStatus,
	win32k_NtUserNotifyProcessCreate,
	win32k_NtUserNotifyWinEvent,
	win32k_NtUserOpenClipboard,
	win32k_NtUserOpenDesktop,
	win32k_NtUserOpenInputDesktop,
	win32k_NtUserOpenWindowStation,
	win32k_NtUserPaintDesktop,
	win32k_NtUserPeekMessage,
	win32k_NtUserPostMessage,
	win32k_NtUserPostThreadMessage,
	win32k_NtUserPrintWindow,
	win32k_NtUserProcessConnect,
	win32k_NtUserQueryInformationThread,
	win32k_NtUserQueryInputContext,
	win32k_NtUserQuerySendMessage,
	win32k_NtUserQueryUserCounters,
	win32k_NtUserQueryWindow,
	win32k_NtUserRealChildWindowFromPoint,
	win32k_NtUserRealInternalGetMessage,
	win32k_NtUserRealWaitMessageEx,
	win32k_NtUserRedrawWindow,
	win32k_NtUserRegisterClassExWOW,
	win32k_NtUserRegisterUserApiHook,
	win32k_NtUserRegisterHotKey,
	win32k_NtUserRegisterRawInputDevices,
	win32k_NtUserRegisterTasklist,
	win32k_NtUserRegisterWindowMessage,
	win32k_NtUserRemoveMenu,
	win32k_NtUserRemoveProp,
	win32k_NtUserResolveDesktop,
	win32k_NtUserResolveDesktopForWOW,
	win32k_NtUserSBGetParms,
	win32k_NtUserScrollDC,
	win32k_NtUserScrollWindowEx,
	win32k_NtUserSelectPalette,
	win32k_NtUserSendInput,
	win32k_NtUserSetActiveWindow,
	win32k_NtUserSetAppImeLevel,
	win32k_NtUserSetCapture,
	win32k_NtUserSetClassLong,
	win32k_NtUserSetClassWord,
	win32k_NtUserSetClipboardData,
	win32k_NtUserSetClipboardViewer,
	win32k_NtUserSetConsoleReserveKeys,
	win32k_NtUserSetCursor,
	win32k_NtUserSetCursorContents,
	win32k_NtUserSetCursorIconData,
	win32k_NtUserSetDbgTag,
	win32k_NtUserSetFocus,
	win32k_NtUserSetImeHotKey,
	win32k_NtUserSetImeInfoEx,
	win32k_NtUserSetImeOwnerWindow,
	win32k_NtUserSetInformationProcess,
	win32k_NtUserSetInformationThread,
	win32k_NtUserSetInternalWindowPos,
	win32k_NtUserSetKeyboardState,
	win32k_NtUserSetLogonNotifyWindow,
	win32k_NtUserSetMenu,
	win32k_NtUserSetMenuContextHelpId,
	win32k_NtUserSetMenuDefaultItem,
	win32k_NtUserSetMenuFlagRtoL,
	win32k_NtUserSetObjectInformation,
	win32k_NtUserSetParent,
	win32k_NtUserSetProcessWindowStation,
	win32k_NtUserSetProp,
	win32k_NtUserSetRipFlags,
	win32k_NtUserSetScrollInfo,
	win32k_NtUserSetShellWindowEx,
	win32k_NtUserSetSysColors,
	win32k_NtUserSetSystemCursor,
	win32k_NtUserSetSystemMenu,
	win32k_NtUserSetSystemTimer,
	win32k_NtUserSetThreadDesktop,
	win32k_NtUserSetThreadLayoutHandles,
	win32k_NtUserSetThreadState,
	win32k_NtUserSetTimer,
	win32k_NtUserSetWindowFNID,
	win32k_NtUserSetWindowLong,
	win32k_NtUserSetWindowPlacement,
	win32k_NtUserSetWindowPos,
	win32k_NtUserSetWindowRgn,
	win32k_NtUserSetWindowsHookAW,
	win32k_NtUserSetWindowsHookEx,
	win32k_NtUserSetWindowStationUser,
	win32k_NtUserSetWindowWord,
	win32k_NtUserSetWinEventHook,
	win32k_NtUserShowCaret,
	win32k_NtUserShowScrollBar,
	win32k_NtUserShowWindow,
	win32k_NtUserShowWindowAsync,
	win32k_NtUserSoundSentry,
	win32k_NtUserSwitchDesktop,
	win32k_NtUserSystemParametersInfo,
	win32k_NtUserTestForInteractiveUser,
	win32k_NtUserThunkedMenuInfo,
	win32k_NtUserThunkedMenuItemInfo,
	win32k_NtUserToUnicodeEx,
	win32k_NtUserTrackMouseEvent,
	win32k_NtUserTrackPopupMenuEx,
	win32k_NtUserCalcMenuBar,
	win32k_NtUserPaintMenuBar,
	win32k_NtUserTranslateAccelerator,
	win32k_NtUserTranslateMessage,
	win32k_NtUserUnhookWindowsHookEx,
	win32k_NtUserUnhookWinEvent,
	win32k_NtUserUnloadKeyboardLayout,
	win32k_NtUserUnlockWindowStation,
	win32k_NtUserUnregisterClass,
	win32k_NtUserUnregisterUserApiHook,
	win32k_NtUserUnregisterHotKey,
	win32k_NtUserUpdateInputContext,
	win32k_NtUserUpdateInstance,
	win32k_NtUserUpdateLayeredWindow,
	win32k_NtUserGetLayeredWindowAttributes,
	win32k_NtUserSetLayeredWindowAttributes,
	win32k_NtUserUpdatePerUserSystemParameters,
	win32k_NtUserUserHandleGrantAccess,
	win32k_NtUserValidateHandleSecure,
	win32k_NtUserValidateRect,
	win32k_NtUserValidateTimerCallback,
	win32k_NtUserVkKeyScanEx,
	win32k_NtUserWaitForInputIdle,
	win32k_NtUserWaitForMsgAndEvent,
	win32k_NtUserWaitMessage,
	win32k_NtUserWin32PoolAllocationStats,
	win32k_NtUserWindowFromPoint,
	win32k_NtUserYieldTask,
	win32k_NtUserRemoteConnect,
	win32k_NtUserRemoteRedrawRectangle,
	win32k_NtUserRemoteRedrawScreen,
	win32k_NtUserRemoteStopScreenUpdates,
	win32k_NtUserCtxDisplayIOCtl,
	win32k_NtGdiEngAssociateSurface,
	win32k_NtGdiEngCreateBitmap,
	win32k_NtGdiEngCreateDeviceSurface,
	win32k_NtGdiEngCreateDeviceBitmap,
	win32k_NtGdiEngCreatePalette,
	win32k_NtGdiEngComputeGlyphSet,
	win32k_NtGdiEngCopyBits,
	win32k_NtGdiEngDeletePalette,
	win32k_NtGdiEngDeleteSurface,
	win32k_NtGdiEngEraseSurface,
	win32k_NtGdiEngUnlockSurface,
	win32k_NtGdiEngLockSurface,
	win32k_NtGdiEngBitBlt,
	win32k_NtGdiEngStretchBlt,
	win32k_NtGdiEngPlgBlt,
	win32k_NtGdiEngMarkBandingSurface,
	win32k_NtGdiEngStrokePath,
	win32k_NtGdiEngFillPath,
	win32k_NtGdiEngStrokeAndFillPath,
	win32k_NtGdiEngPaint,
	win32k_NtGdiEngLineTo,
	win32k_NtGdiEngAlphaBlend,
	win32k_NtGdiEngGradientFill,
	win32k_NtGdiEngTransparentBlt,
	win32k_NtGdiEngTextOut,
	win32k_NtGdiEngStretchBltROP,
	win32k_NtGdiXLATEOBJ_cGetPalette,
	win32k_NtGdiXLATEOBJ_iXlate,
	win32k_NtGdiXLATEOBJ_hGetColorTransform,
	win32k_NtGdiCLIPOBJ_bEnum,
	win32k_NtGdiCLIPOBJ_cEnumStart,
	win32k_NtGdiCLIPOBJ_ppoGetPath,
	win32k_NtGdiEngDeletePath,
	win32k_NtGdiEngCreateClip,
	win32k_NtGdiEngDeleteClip,
	win32k_NtGdiBRUSHOBJ_ulGetBrushColor,
	win32k_NtGdiBRUSHOBJ_pvAllocRbrush,
	win32k_NtGdiBRUSHOBJ_pvGetRbrush,
	win32k_NtGdiBRUSHOBJ_hGetColorTransform,
	win32k_NtGdiXFORMOBJ_bApplyXform,
	win32k_NtGdiXFORMOBJ_iGetXform,
	win32k_NtGdiFONTOBJ_vGetInfo,
	win32k_NtGdiFONTOBJ_pxoGetXform,
	win32k_NtGdiFONTOBJ_cGetGlyphs,
	win32k_NtGdiFONTOBJ_pifi,
	win32k_NtGdiFONTOBJ_pfdg,
	win32k_NtGdiFONTOBJ_pQueryGlyphAttrs,
	win32k_NtGdiFONTOBJ_pvTrueTypeFontFile,
	win32k_NtGdiFONTOBJ_cGetAllGlyphHandles,
	win32k_NtGdiSTROBJ_bEnum,
	win32k_NtGdiSTROBJ_bEnumPositionsOnly,
	win32k_NtGdiSTROBJ_bGetAdvanceWidths,
	win32k_NtGdiSTROBJ_vEnumStart,
	win32k_NtGdiSTROBJ_dwGetCodePage,
	win32k_NtGdiPATHOBJ_vGetBounds,
	win32k_NtGdiPATHOBJ_bEnum,
	win32k_NtGdiPATHOBJ_vEnumStart,
	win32k_NtGdiPATHOBJ_vEnumStartClipLines,
	win32k_NtGdiPATHOBJ_bEnumClipLines,
	win32k_NtGdiGetDhpdev,
	win32k_NtGdiEngCheckAbort,
	win32k_NtGdiHT_Get8BPPFormatPalette,
	win32k_NtGdiHT_Get8BPPMaskPalette,
	win32k_NtGdiUpdateTransform,
	win32k_NtGdiSetPUMPDOBJ,
	win32k_NtGdiBRUSHOBJ_DeleteRbrush,
	win32k_NtGdiUnmapMemFont1,
	win32k_NtGdiDrawStream
};
#endif // WinVer_XP_SP2


#ifdef WinVer_XP_SP3
// SSDT函数表
enum SSDTFuncNum{
	nt_NtAcceptConnectPort,
	nt_NtAccessCheck,
	nt_NtAccessCheckAndAuditAlarm,
	nt_NtAccessCheckByType,
	nt_NtAccessCheckByTypeAndAuditAlarm,
	nt_NtAccessCheckByTypeResultList,
	nt_NtAccessCheckByTypeResultListAndAuditAlarm,
	nt_NtAccessCheckByTypeResultListAndAuditAlarmByHandle,
	nt_NtAddAtom,
	nt_NtQueryBootOptions,
	nt_NtAdjustGroupsToken,
	nt_NtAdjustPrivilegesToken,
	nt_NtAlertResumeThread,
	nt_NtAlertThread,
	nt_NtAllocateLocallyUniqueId,
	nt_NtAllocateUserPhysicalPages,
	nt_NtAllocateUuids,
	nt_NtAllocateVirtualMemory,
	nt_NtAreMappedFilesTheSame,
	nt_NtAssignProcessToJobObject,
	nt_NtCallbackReturn,
	nt_NtModifyBootEntry,
	nt_NtCancelIoFile,
	nt_NtCancelTimer,
	nt_NtClearEvent,
	nt_NtClose,
	nt_NtCloseObjectAuditAlarm,
	nt_NtCompactKeys,
	nt_NtCompareTokens,
	nt_NtCompleteConnectPort,
	nt_NtCompressKey,
	nt_NtConnectPort,
	nt_NtContinue,
	nt_NtCreateDebugObject,
	nt_NtCreateDirectoryObject,
	nt_NtCreateEvent,
	nt_NtCreateEventPair,
	nt_NtCreateFile,
	nt_NtCreateIoCompletion,
	nt_NtCreateJobObject,
	nt_NtCreateJobSet,
	nt_NtCreateKey,
	nt_NtCreateMailslotFile,
	nt_NtCreateMutant,
	nt_NtCreateNamedPipeFile,
	nt_NtCreatePagingFile,
	nt_NtCreatePort,
	nt_NtCreateProcess,
	nt_NtCreateProcessEx,
	nt_NtCreateProfile,
	nt_NtCreateSection,
	nt_NtCreateSemaphore,
	nt_NtCreateSymbolicLinkObject,
	nt_NtCreateThread,
	nt_NtCreateTimer,
	nt_NtCreateToken,
	nt_NtCreateWaitablePort,
	nt_NtDebugActiveProcess,
	nt_NtDebugContinue,
	nt_NtDelayExecution,
	nt_NtDeleteAtom,
	nt_NtModifyBootEntry1,
	nt_NtDeleteFile,
	nt_NtDeleteKey,
	nt_NtDeleteObjectAuditAlarm,
	nt_NtDeleteValueKey,
	nt_NtDeviceIoControlFile,
	nt_NtDisplayString,
	nt_NtDuplicateObject,
	nt_NtDuplicateToken,
	nt_NtQueryBootOptions1,
	nt_NtEnumerateKey,
	nt_NtEnumerateSystemEnvironmentValuesEx,
	nt_NtEnumerateValueKey,
	nt_NtExtendSection,
	nt_NtFilterToken,
	nt_NtFindAtom,
	nt_NtFlushBuffersFile,
	nt_NtFlushInstructionCache,
	nt_NtFlushKey,
	nt_NtFlushVirtualMemory,
	nt_NtFlushWriteBuffer,
	nt_NtFreeUserPhysicalPages,
	nt_NtFreeVirtualMemory,
	nt_NtFsControlFile,
	nt_NtGetContextThread,
	nt_NtGetDevicePowerState,
	nt_NtGetPlugPlayEvent,
	nt_NtGetWriteWatch,
	nt_NtImpersonateAnonymousToken,
	nt_NtImpersonateClientOfPort,
	nt_NtImpersonateThread,
	nt_NtInitializeRegistry,
	nt_NtInitiatePowerAction,
	nt_NtIsProcessInJob,
	nt_NtIsSystemResumeAutomatic,
	nt_NtListenPort,
	nt_NtLoadDriver,
	nt_NtLoadKey,
	nt_NtLoadKey2,
	nt_NtLockFile,
	nt_NtLockProductActivationKeys,
	nt_NtLockRegistryKey,
	nt_NtLockVirtualMemory,
	nt_NtMakePermanentObject,
	nt_NtMakeTemporaryObject,
	nt_NtMapUserPhysicalPages,
	nt_NtMapUserPhysicalPagesScatter,
	nt_NtMapViewOfSection,
	nt_NtModifyBootEntry2,
	nt_NtNotifyChangeDirectoryFile,
	nt_NtNotifyChangeKey,
	nt_NtNotifyChangeMultipleKeys,
	nt_NtOpenDirectoryObject,
	nt_NtOpenEvent,
	nt_NtOpenEventPair,
	nt_NtOpenFile,
	nt_NtOpenIoCompletion,
	nt_NtOpenJobObject,
	nt_NtOpenKey,
	nt_NtOpenMutant,
	nt_NtOpenObjectAuditAlarm,
	nt_NtOpenProcess,
	nt_NtOpenProcessToken,
	nt_NtOpenProcessTokenEx,
	nt_NtOpenSection,
	nt_NtOpenSemaphore,
	nt_NtOpenSymbolicLinkObject,
	nt_NtOpenThread,
	nt_NtOpenThreadToken,
	nt_NtOpenThreadTokenEx,
	nt_NtOpenTimer,
	nt_NtPlugPlayControl,
	nt_NtPowerInformation,
	nt_NtPrivilegeCheck,
	nt_NtPrivilegeObjectAuditAlarm,
	nt_NtPrivilegedServiceAuditAlarm,
	nt_NtProtectVirtualMemory,
	nt_NtPulseEvent,
	nt_NtQueryAttributesFile,
	nt_NtQueryBootOptions2,
	nt_NtQueryBootOptions3,
	nt_NtQueryDebugFilterState,
	nt_NtQueryDefaultLocale,
	nt_NtQueryDefaultUILanguage,
	nt_NtQueryDirectoryFile,
	nt_NtQueryDirectoryObject,
	nt_NtQueryEaFile,
	nt_NtQueryEvent,
	nt_NtQueryFullAttributesFile,
	nt_NtQueryInformationAtom,
	nt_NtQueryInformationFile,
	nt_NtQueryInformationJobObject,
	nt_NtQueryInformationPort,
	nt_NtQueryInformationProcess,
	nt_NtQueryInformationThread,
	nt_NtQueryInformationToken,
	nt_NtQueryInstallUILanguage,
	nt_NtQueryIntervalProfile,
	nt_NtQueryIoCompletion,
	nt_NtQueryKey,
	nt_NtQueryMultipleValueKey,
	nt_NtQueryMutant,
	nt_NtQueryObject,
	nt_NtQueryOpenSubKeys,
	nt_NtQueryPerformanceCounter,
	nt_NtQueryQuotaInformationFile,
	nt_NtQuerySection,
	nt_NtQuerySecurityObject,
	nt_NtQuerySemaphore,
	nt_NtQuerySymbolicLinkObject,
	nt_NtQuerySystemEnvironmentValue,
	nt_NtSetSystemEnvironmentValueEx,
	nt_NtQuerySystemInformation,
	nt_NtQuerySystemTime,
	nt_NtQueryTimer,
	nt_NtQueryTimerResolution,
	nt_NtQueryValueKey,
	nt_NtQueryVirtualMemory,
	nt_NtQueryVolumeInformationFile,
	nt_NtQueueApcThread,
	nt_NtRaiseException,
	nt_NtRaiseHardError,
	nt_NtReadFile,
	nt_NtReadFileScatter,
	nt_NtReadRequestData,
	nt_NtReadVirtualMemory,
	nt_NtRegisterThreadTerminatePort,
	nt_NtReleaseMutant,
	nt_NtReleaseSemaphore,
	nt_NtRemoveIoCompletion,
	nt_NtRemoveProcessDebug,
	nt_NtRenameKey,
	nt_NtReplaceKey,
	nt_NtReplyPort,
	nt_NtReplyWaitReceivePort,
	nt_NtReplyWaitReceivePortEx,
	nt_NtReplyWaitReplyPort,
	nt_NtRequestDeviceWakeup,
	nt_NtRequestPort,
	nt_NtRequestWaitReplyPort,
	nt_NtRequestWakeupLatency,
	nt_NtResetEvent,
	nt_NtResetWriteWatch,
	nt_NtRestoreKey,
	nt_NtResumeProcess,
	nt_NtResumeThread,
	nt_NtSaveKey,
	nt_NtSaveKeyEx,
	nt_NtSaveMergedKeys,
	nt_NtSecureConnectPort,
	nt_NtQueryBootOptions4,
	nt_NtQueryBootOptions5,
	nt_NtSetContextThread,
	nt_NtSetDebugFilterState,
	nt_NtSetDefaultHardErrorPort,
	nt_NtSetDefaultLocale,
	nt_NtSetDefaultUILanguage,
	nt_NtSetEaFile,
	nt_NtSetEvent,
	nt_NtSetEventBoostPriority,
	nt_NtSetHighEventPair,
	nt_NtSetHighWaitLowEventPair,
	nt_NtSetInformationDebugObject,
	nt_NtSetInformationFile,
	nt_NtSetInformationJobObject,
	nt_NtSetInformationKey,
	nt_NtSetInformationObject,
	nt_NtSetInformationProcess,
	nt_NtSetInformationThread,
	nt_NtSetInformationToken,
	nt_NtSetIntervalProfile,
	nt_NtSetIoCompletion,
	nt_NtSetLdtEntries,
	nt_NtSetLowEventPair,
	nt_NtSetLowWaitHighEventPair,
	nt_NtSetQuotaInformationFile,
	nt_NtSetSecurityObject,
	nt_NtSetSystemEnvironmentValue,
	nt_NtSetSystemEnvironmentValueEx1,
	nt_NtSetSystemInformation,
	nt_NtSetSystemPowerState,
	nt_NtSetSystemTime,
	nt_NtSetThreadExecutionState,
	nt_NtSetTimer,
	nt_NtSetTimerResolution,
	nt_NtSetUuidSeed,
	nt_NtSetValueKey,
	nt_NtSetVolumeInformationFile,
	nt_NtShutdownSystem,
	nt_NtSignalAndWaitForSingleObject,
	nt_NtStartProfile,
	nt_NtStopProfile,
	nt_NtSuspendProcess,
	nt_NtSuspendThread,
	nt_NtSystemDebugControl,
	nt_NtTerminateJobObject,
	nt_NtTerminateProcess,
	nt_NtTerminateThread,
	nt_NtTestAlert,
	nt_NtTraceEvent,
	nt_NtTranslateFilePath,
	nt_NtUnloadDriver,
	nt_NtUnloadKey,
	nt_NtUnloadKeyEx,
	nt_NtUnlockFile,
	nt_NtUnlockVirtualMemory,
	nt_NtUnmapViewOfSection,
	nt_NtVdmControl,
	nt_NtWaitForDebugEvent,
	nt_NtWaitForMultipleObjects,
	nt_NtWaitForSingleObject,
	nt_NtWaitHighEventPair,
	nt_NtWaitLowEventPair,
	nt_NtWriteFile,
	nt_NtWriteFileGather,
	nt_NtWriteRequestData,
	nt_NtWriteVirtualMemory,
	nt_NtYieldExecution,
	nt_NtCreateKeyedEvent,
	nt_NtOpenKeyedEvent,
	nt_NtReleaseKeyedEvent,
	nt_NtWaitForKeyedEvent,
	nt_NtQueryPortInformationProcess
};

// SSDTShadow函数表
enum SSDTShadowFuncNum
{
	win32k_NtGdiAbortDoc,
	win32k_NtGdiAbortPath,
	win32k_NtGdiAddFontResourceW,
	win32k_NtGdiAddRemoteFontToDC,
	win32k_NtGdiAddFontMemResourceEx,
	win32k_NtGdiRemoveMergeFont,
	win32k_NtGdiAddRemoteMMInstanceToDC,
	win32k_NtGdiAlphaBlend,
	win32k_NtGdiAngleArc,
	win32k_NtGdiAnyLinkedFonts,
	win32k_NtGdiFontIsLinked,
	win32k_NtGdiArcInternal,
	win32k_NtGdiBeginPath,
	win32k_NtGdiBitBlt,
	win32k_NtGdiCancelDC,
	win32k_NtGdiCheckBitmapBits,
	win32k_NtGdiCloseFigure,
	win32k_NtGdiClearBitmapAttributes,
	win32k_NtGdiClearBrushAttributes,
	win32k_NtGdiColorCorrectPalette,
	win32k_NtGdiCombineRgn,
	win32k_NtGdiCombineTransform,
	win32k_NtGdiComputeXformCoefficients,
	win32k_NtGdiConsoleTextOut,
	win32k_NtGdiConvertMetafileRect,
	win32k_NtGdiCreateBitmap,
	win32k_NtGdiCreateClientObj,
	win32k_NtGdiCreateColorSpace,
	win32k_NtGdiCreateColorTransform,
	win32k_NtGdiCreateCompatibleBitmap,
	win32k_NtGdiCreateCompatibleDC,
	win32k_NtGdiCreateDIBBrush,
	win32k_NtGdiCreateDIBitmapInternal,
	win32k_NtGdiCreateDIBSection,
	win32k_NtGdiCreateEllipticRgn,
	win32k_NtGdiCreateHalftonePalette,
	win32k_NtGdiCreateHatchBrushInternal,
	win32k_NtGdiCreateMetafileDC,
	win32k_NtGdiCreatePaletteInternal,
	win32k_NtGdiCreatePatternBrushInternal,
	win32k_NtGdiCreatePen,
	win32k_NtGdiCreateRectRgn,
	win32k_NtGdiCreateRoundRectRgn,
	win32k_NtGdiCreateServerMetaFile,
	win32k_NtGdiCreateSolidBrush,
	win32k_NtGdiD3dContextCreate,
	win32k_NtGdiD3dContextDestroy,
	win32k_NtGdiD3dContextDestroyAll,
	win32k_NtGdiD3dValidateTextureStageState,
	win32k_NtGdiD3dDrawPrimitives2,
	win32k_NtGdiDdGetDriverState,
	win32k_NtGdiDdAddAttachedSurface,
	win32k_NtGdiDdAlphaBlt,
	win32k_NtGdiDdAttachSurface,
	win32k_NtGdiDdBeginMoCompFrame,
	win32k_NtGdiDdBlt,
	win32k_NtGdiDdCanCreateSurface,
	win32k_NtGdiDdCanCreateD3DBuffer,
	win32k_NtGdiDdColorControl,
	win32k_NtGdiDdCreateDirectDrawObject,
	win32k_NtGdiDdCreateSurface,
	win32k_NtGdiDdCreateD3DBuffer,
	win32k_NtGdiDdCreateMoComp,
	win32k_NtGdiDdCreateSurfaceObject,
	win32k_NtGdiDdDeleteDirectDrawObject,
	win32k_NtGdiDdDeleteSurfaceObject,
	win32k_NtGdiDdDestroyMoComp,
	win32k_NtGdiDdDestroySurface,
	win32k_NtGdiDdDestroyD3DBuffer,
	win32k_NtGdiDdEndMoCompFrame,
	win32k_NtGdiDdFlip,
	win32k_NtGdiDdFlipToGDISurface,
	win32k_NtGdiDdGetAvailDriverMemory,
	win32k_NtGdiDdGetBltStatus,
	win32k_NtGdiDdGetDC,
	win32k_NtGdiDdGetDriverInfo,
	win32k_NtGdiDdGetDxHandle,
	win32k_NtGdiDdGetFlipStatus,
	win32k_NtGdiDdGetInternalMoCompInfo,
	win32k_NtGdiDdGetMoCompBuffInfo,
	win32k_NtGdiDdGetMoCompGuids,
	win32k_NtGdiDdGetMoCompFormats,
	win32k_NtGdiDdGetScanLine,
	win32k_NtGdiDdLock,
	win32k_NtGdiDdLockD3D,
	win32k_NtGdiDdQueryDirectDrawObject,
	win32k_NtGdiDdQueryMoCompStatus,
	win32k_NtGdiDdReenableDirectDrawObject,
	win32k_NtGdiDdReleaseDC,
	win32k_NtGdiDdRenderMoComp,
	win32k_NtGdiDdResetVisrgn,
	win32k_NtGdiDdSetColorKey,
	win32k_NtGdiDdSetExclusiveMode,
	win32k_NtGdiDdSetGammaRamp,
	win32k_NtGdiDdCreateSurfaceEx,
	win32k_NtGdiDdSetOverlayPosition,
	win32k_NtGdiDdUnattachSurface,
	win32k_NtGdiDdUnlock,
	win32k_NtGdiDdUnlockD3D,
	win32k_NtGdiDdUpdateOverlay,
	win32k_NtGdiDdWaitForVerticalBlank,
	win32k_NtGdiDvpCanCreateVideoPort,
	win32k_NtGdiDvpColorControl,
	win32k_NtGdiDvpCreateVideoPort,
	win32k_NtGdiDvpDestroyVideoPort,
	win32k_NtGdiDvpFlipVideoPort,
	win32k_NtGdiDvpGetVideoPortBandwidth,
	win32k_NtGdiDvpGetVideoPortField,
	win32k_NtGdiDvpGetVideoPortFlipStatus,
	win32k_NtGdiDvpGetVideoPortInputFormats,
	win32k_NtGdiDvpGetVideoPortLine,
	win32k_NtGdiDvpGetVideoPortOutputFormats,
	win32k_NtGdiDvpGetVideoPortConnectInfo,
	win32k_NtGdiDvpGetVideoSignalStatus,
	win32k_NtGdiDvpUpdateVideoPort,
	win32k_NtGdiDvpWaitForVideoPortSync,
	win32k_NtGdiDvpAcquireNotification,
	win32k_NtGdiDvpReleaseNotification,
	win32k_NtGdiDxgGenericThunk,
	win32k_NtGdiDeleteClientObj,
	win32k_NtGdiDeleteColorSpace,
	win32k_NtGdiDeleteColorTransform,
	win32k_NtGdiDeleteObjectApp,
	win32k_NtGdiDescribePixelFormat,
	win32k_NtGdiGetPerBandInfo,
	win32k_NtGdiDoBanding,
	win32k_NtGdiDoPalette,
	win32k_NtGdiDrawEscape,
	win32k_NtGdiEllipse,
	win32k_NtGdiEnableEudc,
	win32k_NtGdiEndDoc,
	win32k_NtGdiEndPage,
	win32k_NtGdiEndPath,
	win32k_NtGdiEnumFontChunk,
	win32k_NtGdiEnumFontClose,
	win32k_NtGdiEnumFontOpen,
	win32k_NtGdiEnumObjects,
	win32k_NtGdiEqualRgn,
	win32k_NtGdiEudcLoadUnloadLink,
	win32k_NtGdiExcludeClipRect,
	win32k_NtGdiExtCreatePen,
	win32k_NtGdiExtCreateRegion,
	win32k_NtGdiExtEscape,
	win32k_NtGdiExtFloodFill,
	win32k_NtGdiExtGetObjectW,
	win32k_NtGdiExtSelectClipRgn,
	win32k_NtGdiExtTextOutW,
	win32k_NtGdiFillPath,
	win32k_NtGdiFillRgn,
	win32k_NtGdiFlattenPath,
	win32k_NtGdiFlushUserBatch,
	win32k_NtGdiFlush,
	win32k_NtGdiForceUFIMapping,
	win32k_NtGdiFrameRgn,
	win32k_NtGdiFullscreenControl,
	win32k_NtGdiGetAndSetDCDword,
	win32k_NtGdiGetAppClipBox,
	win32k_NtGdiGetBitmapBits,
	win32k_NtGdiGetBitmapDimension,
	win32k_NtGdiGetBoundsRect,
	win32k_NtGdiGetCharABCWidthsW,
	win32k_NtGdiGetCharacterPlacementW,
	win32k_NtGdiGetCharSet,
	win32k_NtGdiGetCharWidthW,
	win32k_NtGdiGetCharWidthInfo,
	win32k_NtGdiGetColorAdjustment,
	win32k_NtGdiGetColorSpaceforBitmap,
	win32k_NtGdiGetDCDword,
	win32k_NtGdiGetDCforBitmap,
	win32k_NtGdiGetDCObject,
	win32k_NtGdiGetDCPoint,
	win32k_NtGdiGetDeviceCaps,
	win32k_NtGdiGetDeviceGammaRamp,
	win32k_NtGdiGetDeviceCapsAll,
	win32k_NtGdiGetDIBitsInternal,
	win32k_NtGdiGetETM,
	win32k_NtGdiGetEudcTimeStampEx,
	win32k_NtGdiGetFontData,
	win32k_NtGdiGetFontResourceInfoInternalW,
	win32k_NtGdiGetGlyphIndicesW,
	win32k_NtGdiGetGlyphIndicesWInternal,
	win32k_NtGdiGetGlyphOutline,
	win32k_NtGdiGetKerningPairs,
	win32k_NtGdiGetLinkedUFIs,
	win32k_NtGdiGetMiterLimit,
	win32k_NtGdiGetMonitorID,
	win32k_NtGdiGetNearestColor,
	win32k_NtGdiGetNearestPaletteIndex,
	win32k_NtGdiGetObjectBitmapHandle,
	win32k_NtGdiGetOutlineTextMetricsInternalW,
	win32k_NtGdiGetPath,
	win32k_NtGdiGetPixel,
	win32k_NtGdiGetRandomRgn,
	win32k_NtGdiGetRasterizerCaps,
	win32k_NtGdiGetRealizationInfo,
	win32k_NtGdiGetRegionData,
	win32k_NtGdiGetRgnBox,
	win32k_NtGdiGetServerMetaFileBits,
	win32k_NtGdiGetSpoolMessage,
	win32k_NtGdiGetStats,
	win32k_NtGdiGetStockObject,
	win32k_NtGdiGetStringBitmapW,
	win32k_NtGdiGetSystemPaletteUse,
	win32k_NtGdiGetTextCharsetInfo,
	win32k_NtGdiGetTextExtent,
	win32k_NtGdiGetTextExtentExW,
	win32k_NtGdiGetTextFaceW,
	win32k_NtGdiGetTextMetricsW,
	win32k_NtGdiGetTransform,
	win32k_NtGdiGetUFI,
	win32k_NtGdiGetEmbUFI,
	win32k_NtGdiGetUFIPathname,
	win32k_NtGdiGetEmbedFonts,
	win32k_NtGdiChangeGhostFont,
	win32k_NtGdiAddEmbFontToDC,
	win32k_NtGdiGetFontUnicodeRanges,
	win32k_NtGdiGetWidthTable,
	win32k_NtGdiGradientFill,
	win32k_NtGdiHfontCreate,
	win32k_NtGdiIcmBrushInfo,
	win32k_NtGdiInit,
	win32k_NtGdiInitSpool,
	win32k_NtGdiIntersectClipRect,
	win32k_NtGdiInvertRgn,
	win32k_NtGdiLineTo,
	win32k_NtGdiMakeFontDir,
	win32k_NtGdiMakeInfoDC,
	win32k_NtGdiMaskBlt,
	win32k_NtGdiModifyWorldTransform,
	win32k_NtGdiMonoBitmap,
	win32k_NtGdiMoveTo,
	win32k_NtGdiOffsetClipRgn,
	win32k_NtGdiOffsetRgn,
	win32k_NtGdiOpenDCW,
	win32k_NtGdiPatBlt,
	win32k_NtGdiPolyPatBlt,
	win32k_NtGdiPathToRegion,
	win32k_NtGdiPlgBlt,
	win32k_NtGdiPolyDraw,
	win32k_NtGdiPolyPolyDraw,
	win32k_NtGdiPolyTextOutW,
	win32k_NtGdiPtInRegion,
	win32k_NtGdiPtVisible,
	win32k_NtGdiQueryFonts,
	win32k_NtGdiQueryFontAssocInfo,
	win32k_NtGdiRectangle,
	win32k_NtGdiRectInRegion,
	win32k_NtGdiRectVisible,
	win32k_NtGdiRemoveFontResourceW,
	win32k_NtGdiRemoveFontMemResourceEx,
	win32k_NtGdiResetDC,
	win32k_NtGdiResizePalette,
	win32k_NtGdiRestoreDC,
	win32k_NtGdiRoundRect,
	win32k_NtGdiSaveDC,
	win32k_NtGdiScaleViewportExtEx,
	win32k_NtGdiScaleWindowExtEx,
	win32k_NtGdiSelectBitmap,
	win32k_NtGdiSelectBrush,
	win32k_NtGdiSelectClipPath,
	win32k_NtGdiSelectFont,
	win32k_NtGdiSelectPen,
	win32k_NtGdiSetBitmapAttributes,
	win32k_NtGdiSetBitmapBits,
	win32k_NtGdiSetBitmapDimension,
	win32k_NtGdiSetBoundsRect,
	win32k_NtGdiSetBrushAttributes,
	win32k_NtGdiSetBrushOrg,
	win32k_NtGdiSetColorAdjustment,
	win32k_NtGdiSetColorSpace,
	win32k_NtGdiSetDeviceGammaRamp,
	win32k_NtGdiSetDIBitsToDeviceInternal,
	win32k_NtGdiSetFontEnumeration,
	win32k_NtGdiSetFontXform,
	win32k_NtGdiSetIcmMode,
	win32k_NtGdiSetLinkedUFIs,
	win32k_NtGdiSetMagicColors,
	win32k_NtGdiSetMetaRgn,
	win32k_NtGdiSetMiterLimit,
	win32k_NtGdiGetDeviceWidth,
	win32k_NtGdiMirrorWindowOrg,
	win32k_NtGdiSetLayout,
	win32k_NtGdiSetPixel,
	win32k_NtGdiSetPixelFormat,
	win32k_NtGdiSetRectRgn,
	win32k_NtGdiSetSystemPaletteUse,
	win32k_NtGdiSetTextJustification,
	win32k_NtGdiSetupPublicCFONT,
	win32k_NtGdiSetVirtualResolution,
	win32k_NtGdiSetSizeDevice,
	win32k_NtGdiStartDoc,
	win32k_NtGdiStartPage,
	win32k_NtGdiStretchBlt,
	win32k_NtGdiStretchDIBitsInternal,
	win32k_NtGdiStrokeAndFillPath,
	win32k_NtGdiStrokePath,
	win32k_NtGdiSwapBuffers,
	win32k_NtGdiTransformPoints,
	win32k_NtGdiTransparentBlt,
	win32k_NtGdiUnloadPrinterDriver,
	win32k_NtGdiUnmapMemFont,
	win32k_NtGdiUnrealizeObject,
	win32k_NtGdiUpdateColors,
	win32k_NtGdiWidenPath,
	win32k_NtUserActivateKeyboardLayout,
	win32k_NtUserAlterWindowStyle,
	win32k_NtUserAssociateInputContext,
	win32k_NtUserAttachThreadInput,
	win32k_NtUserBeginPaint,
	win32k_NtUserBitBltSysBmp,
	win32k_NtUserBlockInput,
	win32k_NtUserBuildHimcList,
	win32k_NtUserBuildHwndList,
	win32k_NtUserBuildNameList,
	win32k_NtUserBuildPropList,
	win32k_NtUserCallHwnd,
	win32k_NtUserCallHwndLock,
	win32k_NtUserCallHwndOpt,
	win32k_NtUserCallHwndParam,
	win32k_NtUserCallHwndParamLock,
	win32k_NtUserCallMsgFilter,
	win32k_NtUserCallNextHookEx,
	win32k_NtUserCallNoParam,
	win32k_NtUserCallOneParam,
	win32k_NtUserCallTwoParam,
	win32k_NtUserChangeClipboardChain,
	win32k_NtUserChangeDisplaySettings,
	win32k_NtUserCheckImeHotKey,
	win32k_NtUserCheckMenuItem,
	win32k_NtUserChildWindowFromPointEx,
	win32k_NtUserClipCursor,
	win32k_NtUserCloseClipboard,
	win32k_NtUserCloseDesktop,
	win32k_NtUserCloseWindowStation,
	win32k_NtUserConsoleControl,
	win32k_NtUserConvertMemHandle,
	win32k_NtUserCopyAcceleratorTable,
	win32k_NtUserCountClipboardFormats,
	win32k_NtUserCreateAcceleratorTable,
	win32k_NtUserCreateCaret,
	win32k_NtUserCreateDesktop,
	win32k_NtUserCreateInputContext,
	win32k_NtUserCreateLocalMemHandle,
	win32k_NtUserCreateWindowEx,
	win32k_NtUserCreateWindowStation,
	win32k_NtUserDdeGetQualityOfService,
	win32k_NtUserDdeInitialize,
	win32k_NtUserDdeSetQualityOfService,
	win32k_NtUserDeferWindowPos,
	win32k_NtUserDefSetText,
	win32k_NtUserDeleteMenu,
	win32k_NtUserDestroyAcceleratorTable,
	win32k_NtUserDestroyCursor,
	win32k_NtUserDestroyInputContext,
	win32k_NtUserDestroyMenu,
	win32k_NtUserDestroyWindow,
	win32k_NtUserDisableThreadIme,
	win32k_NtUserDispatchMessage,
	win32k_NtUserDragDetect,
	win32k_NtUserDragObject,
	win32k_NtUserDrawAnimatedRects,
	win32k_NtUserDrawCaption,
	win32k_NtUserDrawCaptionTemp,
	win32k_NtUserDrawIconEx,
	win32k_NtUserDrawMenuBarTemp,
	win32k_NtUserEmptyClipboard,
	win32k_NtUserEnableMenuItem,
	win32k_NtUserEnableScrollBar,
	win32k_NtUserEndDeferWindowPosEx,
	win32k_NtUserEndMenu,
	win32k_NtUserEndPaint,
	win32k_NtUserEnumDisplayDevices,
	win32k_NtUserEnumDisplayMonitors,
	win32k_NtUserEnumDisplaySettings,
	win32k_NtUserEvent,
	win32k_NtUserExcludeUpdateRgn,
	win32k_NtUserFillWindow,
	win32k_NtUserFindExistingCursorIcon,
	win32k_NtUserFindWindowEx,
	win32k_NtUserFlashWindowEx,
	win32k_NtUserGetAltTabInfo,
	win32k_NtUserGetAncestor,
	win32k_NtUserGetAppImeLevel,
	win32k_NtUserGetAsyncKeyState,
	win32k_NtUserGetAtomName,
	win32k_NtUserGetCaretBlinkTime,
	win32k_NtUserGetCaretPos,
	win32k_NtUserGetClassInfo,
	win32k_NtUserGetClassName,
	win32k_NtUserGetClipboardData,
	win32k_NtUserGetClipboardFormatName,
	win32k_NtUserGetClipboardOwner,
	win32k_NtUserGetClipboardSequenceNumber,
	win32k_NtUserGetClipboardViewer,
	win32k_NtUserGetClipCursor,
	win32k_NtUserGetComboBoxInfo,
	win32k_NtUserGetControlBrush,
	win32k_NtUserGetControlColor,
	win32k_NtUserGetCPD,
	win32k_NtUserGetCursorFrameInfo,
	win32k_NtUserGetCursorInfo,
	win32k_NtUserGetDC,
	win32k_NtUserGetDCEx,
	win32k_NtUserGetDoubleClickTime,
	win32k_NtUserGetForegroundWindow,
	win32k_NtUserGetGuiResources,
	win32k_NtUserGetGUIThreadInfo,
	win32k_NtUserGetIconInfo,
	win32k_NtUserGetIconSize,
	win32k_NtUserGetImeHotKey,
	win32k_NtUserGetImeInfoEx,
	win32k_NtUserGetInternalWindowPos,
	win32k_NtUserGetKeyboardLayoutList,
	win32k_NtUserGetKeyboardLayoutName,
	win32k_NtUserGetKeyboardState,
	win32k_NtUserGetKeyNameText,
	win32k_NtUserGetKeyState,
	win32k_NtUserGetListBoxInfo,
	win32k_NtUserGetMenuBarInfo,
	win32k_NtUserGetMenuIndex,
	win32k_NtUserGetMenuItemRect,
	win32k_NtUserGetMessage,
	win32k_NtUserGetMouseMovePointsEx,
	win32k_NtUserGetObjectInformation,
	win32k_NtUserGetOpenClipboardWindow,
	win32k_NtUserGetPriorityClipboardFormat,
	win32k_NtUserGetProcessWindowStation,
	win32k_NtUserGetRawInputBuffer,
	win32k_NtUserGetRawInputData,
	win32k_NtUserGetRawInputDeviceInfo,
	win32k_NtUserGetRawInputDeviceList,
	win32k_NtUserGetRegisteredRawInputDevices,
	win32k_NtUserGetScrollBarInfo,
	win32k_NtUserGetSystemMenu,
	win32k_NtUserGetThreadDesktop,
	win32k_NtUserGetThreadState,
	win32k_NtUserGetTitleBarInfo,
	win32k_NtUserGetUpdateRect,
	win32k_NtUserGetUpdateRgn,
	win32k_NtUserGetWindowDC,
	win32k_NtUserGetWindowPlacement,
	win32k_NtUserGetWOWClass,
	win32k_NtUserHardErrorControl,
	win32k_NtUserHideCaret,
	win32k_NtUserHiliteMenuItem,
	win32k_NtUserImpersonateDdeClientWindow,
	win32k_NtUserInitialize,
	win32k_NtUserInitializeClientPfnArrays,
	win32k_NtUserInitTask,
	win32k_NtUserInternalGetWindowText,
	win32k_NtUserInvalidateRect,
	win32k_NtUserInvalidateRgn,
	win32k_NtUserIsClipboardFormatAvailable,
	win32k_NtUserKillTimer,
	win32k_NtUserLoadKeyboardLayoutEx,
	win32k_NtUserLockWindowStation,
	win32k_NtUserLockWindowUpdate,
	win32k_NtUserLockWorkStation,
	win32k_NtUserMapVirtualKeyEx,
	win32k_NtUserMenuItemFromPoint,
	win32k_NtUserMessageCall,
	win32k_NtUserMinMaximize,
	win32k_NtUserMNDragLeave,
	win32k_NtUserMNDragOver,
	win32k_NtUserModifyUserStartupInfoFlags,
	win32k_NtUserMoveWindow,
	win32k_NtUserNotifyIMEStatus,
	win32k_NtUserNotifyProcessCreate,
	win32k_NtUserNotifyWinEvent,
	win32k_NtUserOpenClipboard,
	win32k_NtUserOpenDesktop,
	win32k_NtUserOpenInputDesktop,
	win32k_NtUserOpenWindowStation,
	win32k_NtUserPaintDesktop,
	win32k_NtUserPeekMessage,
	win32k_NtUserPostMessage,
	win32k_NtUserPostThreadMessage,
	win32k_NtUserPrintWindow,
	win32k_NtUserProcessConnect,
	win32k_NtUserQueryInformationThread,
	win32k_NtUserQueryInputContext,
	win32k_NtUserQuerySendMessage,
	win32k_NtUserQueryUserCounters,
	win32k_NtUserQueryWindow,
	win32k_NtUserRealChildWindowFromPoint,
	win32k_NtUserRealInternalGetMessage,
	win32k_NtUserRealWaitMessageEx,
	win32k_NtUserRedrawWindow,
	win32k_NtUserRegisterClassExWOW,
	win32k_NtUserRegisterUserApiHook,
	win32k_NtUserRegisterHotKey,
	win32k_NtUserRegisterRawInputDevices,
	win32k_NtUserRegisterTasklist,
	win32k_NtUserRegisterWindowMessage,
	win32k_NtUserRemoveMenu,
	win32k_NtUserRemoveProp,
	win32k_NtUserResolveDesktop,
	win32k_NtUserResolveDesktopForWOW,
	win32k_NtUserSBGetParms,
	win32k_NtUserScrollDC,
	win32k_NtUserScrollWindowEx,
	win32k_NtUserSelectPalette,
	win32k_NtUserSendInput,
	win32k_NtUserSetActiveWindow,
	win32k_NtUserSetAppImeLevel,
	win32k_NtUserSetCapture,
	win32k_NtUserSetClassLong,
	win32k_NtUserSetClassWord,
	win32k_NtUserSetClipboardData,
	win32k_NtUserSetClipboardViewer,
	win32k_NtUserSetConsoleReserveKeys,
	win32k_NtUserSetCursor,
	win32k_NtUserSetCursorContents,
	win32k_NtUserSetCursorIconData,
	win32k_NtUserSetDbgTag,
	win32k_NtUserSetFocus,
	win32k_NtUserSetImeHotKey,
	win32k_NtUserSetImeInfoEx,
	win32k_NtUserSetImeOwnerWindow,
	win32k_NtUserSetInformationProcess,
	win32k_NtUserSetInformationThread,
	win32k_NtUserSetInternalWindowPos,
	win32k_NtUserSetKeyboardState,
	win32k_NtUserSetLogonNotifyWindow,
	win32k_NtUserSetMenu,
	win32k_NtUserSetMenuContextHelpId,
	win32k_NtUserSetMenuDefaultItem,
	win32k_NtUserSetMenuFlagRtoL,
	win32k_NtUserSetObjectInformation,
	win32k_NtUserSetParent,
	win32k_NtUserSetProcessWindowStation,
	win32k_NtUserSetProp,
	win32k_NtUserSetRipFlags,
	win32k_NtUserSetScrollInfo,
	win32k_NtUserSetShellWindowEx,
	win32k_NtUserSetSysColors,
	win32k_NtUserSetSystemCursor,
	win32k_NtUserSetSystemMenu,
	win32k_NtUserSetSystemTimer,
	win32k_NtUserSetThreadDesktop,
	win32k_NtUserSetThreadLayoutHandles,
	win32k_NtUserSetThreadState,
	win32k_NtUserSetTimer,
	win32k_NtUserSetWindowFNID,
	win32k_NtUserSetWindowLong,
	win32k_NtUserSetWindowPlacement,
	win32k_NtUserSetWindowPos,
	win32k_NtUserSetWindowRgn,
	win32k_NtUserSetWindowsHookAW,
	win32k_NtUserSetWindowsHookEx,
	win32k_NtUserSetWindowStationUser,
	win32k_NtUserSetWindowWord,
	win32k_NtUserSetWinEventHook,
	win32k_NtUserShowCaret,
	win32k_NtUserShowScrollBar,
	win32k_NtUserShowWindow,
	win32k_NtUserShowWindowAsync,
	win32k_NtUserSoundSentry,
	win32k_NtUserSwitchDesktop,
	win32k_NtUserSystemParametersInfo,
	win32k_NtUserTestForInteractiveUser,
	win32k_NtUserThunkedMenuInfo,
	win32k_NtUserThunkedMenuItemInfo,
	win32k_NtUserToUnicodeEx,
	win32k_NtUserTrackMouseEvent,
	win32k_NtUserTrackPopupMenuEx,
	win32k_NtUserCalcMenuBar,
	win32k_NtUserPaintMenuBar,
	win32k_NtUserTranslateAccelerator,
	win32k_NtUserTranslateMessage,
	win32k_NtUserUnhookWindowsHookEx,
	win32k_NtUserUnhookWinEvent,
	win32k_NtUserUnloadKeyboardLayout,
	win32k_NtUserUnlockWindowStation,
	win32k_NtUserUnregisterClass,
	win32k_NtUserUnregisterUserApiHook,
	win32k_NtUserUnregisterHotKey,
	win32k_NtUserUpdateInputContext,
	win32k_NtUserUpdateInstance,
	win32k_NtUserUpdateLayeredWindow,
	win32k_NtUserGetLayeredWindowAttributes,
	win32k_NtUserSetLayeredWindowAttributes,
	win32k_NtUserUpdatePerUserSystemParameters,
	win32k_NtUserUserHandleGrantAccess,
	win32k_NtUserValidateHandleSecure,
	win32k_NtUserValidateRect,
	win32k_NtUserValidateTimerCallback,
	win32k_NtUserVkKeyScanEx,
	win32k_NtUserWaitForInputIdle,
	win32k_NtUserWaitForMsgAndEvent,
	win32k_NtUserWaitMessage,
	win32k_NtUserWin32PoolAllocationStats,
	win32k_NtUserWindowFromPoint,
	win32k_NtUserYieldTask,
	win32k_NtUserRemoteConnect,
	win32k_NtUserRemoteRedrawRectangle,
	win32k_NtUserRemoteRedrawScreen,
	win32k_NtUserRemoteStopScreenUpdates,
	win32k_NtUserCtxDisplayIOCtl,
	win32k_NtGdiEngAssociateSurface,
	win32k_NtGdiEngCreateBitmap,
	win32k_NtGdiEngCreateDeviceSurface,
	win32k_NtGdiEngCreateDeviceBitmap,
	win32k_NtGdiEngCreatePalette,
	win32k_NtGdiEngComputeGlyphSet,
	win32k_NtGdiEngCopyBits,
	win32k_NtGdiEngDeletePalette,
	win32k_NtGdiEngDeleteSurface,
	win32k_NtGdiEngEraseSurface,
	win32k_NtGdiEngUnlockSurface,
	win32k_NtGdiEngLockSurface,
	win32k_NtGdiEngBitBlt,
	win32k_NtGdiEngStretchBlt,
	win32k_NtGdiEngPlgBlt,
	win32k_NtGdiEngMarkBandingSurface,
	win32k_NtGdiEngStrokePath,
	win32k_NtGdiEngFillPath,
	win32k_NtGdiEngStrokeAndFillPath,
	win32k_NtGdiEngPaint,
	win32k_NtGdiEngLineTo,
	win32k_NtGdiEngAlphaBlend,
	win32k_NtGdiEngGradientFill,
	win32k_NtGdiEngTransparentBlt,
	win32k_NtGdiEngTextOut,
	win32k_NtGdiEngStretchBltROP,
	win32k_NtGdiXLATEOBJ_cGetPalette,
	win32k_NtGdiXLATEOBJ_iXlate,
	win32k_NtGdiXLATEOBJ_hGetColorTransform,
	win32k_NtGdiCLIPOBJ_bEnum,
	win32k_NtGdiCLIPOBJ_cEnumStart,
	win32k_NtGdiCLIPOBJ_ppoGetPath,
	win32k_NtGdiEngDeletePath,
	win32k_NtGdiEngCreateClip,
	win32k_NtGdiEngDeleteClip,
	win32k_NtGdiBRUSHOBJ_ulGetBrushColor,
	win32k_NtGdiBRUSHOBJ_pvAllocRbrush,
	win32k_NtGdiBRUSHOBJ_pvGetRbrush,
	win32k_NtGdiBRUSHOBJ_hGetColorTransform,
	win32k_NtGdiXFORMOBJ_bApplyXform,
	win32k_NtGdiXFORMOBJ_iGetXform,
	win32k_NtGdiFONTOBJ_vGetInfo,
	win32k_NtGdiFONTOBJ_pxoGetXform,
	win32k_NtGdiFONTOBJ_cGetGlyphs,
	win32k_NtGdiFONTOBJ_pifi,
	win32k_NtGdiFONTOBJ_pfdg,
	win32k_NtGdiFONTOBJ_pQueryGlyphAttrs,
	win32k_NtGdiFONTOBJ_pvTrueTypeFontFile,
	win32k_NtGdiFONTOBJ_cGetAllGlyphHandles,
	win32k_NtGdiSTROBJ_bEnum,
	win32k_NtGdiSTROBJ_bEnumPositionsOnly,
	win32k_NtGdiSTROBJ_bGetAdvanceWidths,
	win32k_NtGdiSTROBJ_vEnumStart,
	win32k_NtGdiSTROBJ_dwGetCodePage,
	win32k_NtGdiPATHOBJ_vGetBounds,
	win32k_NtGdiPATHOBJ_bEnum,
	win32k_NtGdiPATHOBJ_vEnumStart,
	win32k_NtGdiPATHOBJ_vEnumStartClipLines,
	win32k_NtGdiPATHOBJ_bEnumClipLines,
	win32k_NtGdiGetDhpdev,
	win32k_NtGdiEngCheckAbort,
	win32k_NtGdiHT_Get8BPPFormatPalette,
	win32k_NtGdiHT_Get8BPPMaskPalette,
	win32k_NtGdiUpdateTransform,
	win32k_NtGdiSetPUMPDOBJ,
	win32k_NtGdiBRUSHOBJ_DeleteRbrush,
	win32k_NtGdiUnmapMemFont1,
	win32k_NtGdiDrawStream
};
#endif // WinVer_XP_SP3


typedef struct _tagSSDT {
	PULONG pvSSDTBase;
	PULONG pvServiceCounterTable;
	ULONG ulNumberOfServices;
	PULONG pvParamTableBase;
} SSDT, *PSSDT;

NTSTATUS InstallSDDTHook();
VOID UnInstallSDDTHook();
PSSDT FindSSDTShadow();
void SaveSSDTTable(PSSDT pSSDT,ULONG SSDTTable[MAX_SSDT_ITEM_NUM]);
void LoadSSDTTable(PSSDT pSSDT,ULONG SSDTTable[MAX_SSDT_ITEM_NUM]);
void InstallSSDTHookByIndex(PSSDT pSSDT,ULONG ulServerNum, ULONG pNewService);
void UnInstallSSDTHookByIndex(PSSDT pSSDT,ULONG ulServerNum,ULONG ulSSDTTable[MAX_SSDT_ITEM_NUM]);

// Hook函数声明

NTSTATUS
HookNtOpenProcess (
				   __out PHANDLE  ProcessHandle,
				   __in ACCESS_MASK  DesiredAccess,
				   __in POBJECT_ATTRIBUTES  ObjectAttributes,
				   __in_opt PCLIENT_ID  ClientId
				   );

NTSTATUS HookNtCreateThread(
							__out PHANDLE ThreadHandle,
							__in ACCESS_MASK DesiredAccess,
							__in_opt POBJECT_ATTRIBUTES ObjectAttributes,
							__in HANDLE ProcessHandle,
							__out PCLIENT_ID ClientId,
							__in PCONTEXT ThreadContext,
							__in PVOID InitialTeb,
							__in BOOLEAN CreateSuspended
							);

HHOOK HookNtUserSetWindowsHookEx(
								 HINSTANCE Mod, 
								 PUNICODE_STRING UnsafeModuleName, 
								 DWORD ThreadId, 
								 int HookId, 
								 PVOID HookProc,
								 BOOL Ansi);

BOOL HookNtUserMessageCall(
						   HWND hWnd,
						   UINT Msg,
						   WPARAM wParam,
						   LPARAM lParam,
						   ULONG_PTR ResultInfo,
						   DWORD dwType,
						   BOOL Ansi);

NTSTATUS HookNtCreateProcessEx(
							   __out PHANDLE ProcessHandle,
							   __in ACCESS_MASK DesiredAccess,
							   __in_opt POBJECT_ATTRIBUTES ObjectAttributes,
							   __in HANDLE ParentProcess,
							   __in ULONG Flags,
							   __in_opt HANDLE SectionHandle,
							   __in_opt HANDLE DebugPort,
							   __in_opt HANDLE ExceptionPort,
							   __in ULONG JobMemberLevel
							   );
NTSTATUS HookNtCreateSection(
							 __out PHANDLE SectionHandle,
							 __in ACCESS_MASK DesiredAccess,
							 __in_opt POBJECT_ATTRIBUTES ObjectAttributes,
							 __in_opt PLARGE_INTEGER MaximumSize,
							 __in ULONG SectionPageProtection,
							 __in ULONG AllocationAttributes,
							 __in_opt HANDLE FileHandle
							 );

typedef ULONG WIN32_PROTECTION_MASK;
NTSTATUS HookNtMapViewOfSection(
								__in HANDLE SectionHandle,
								__in HANDLE ProcessHandle,
								__inout PVOID *BaseAddress,
								__in ULONG_PTR ZeroBits,
								__in SIZE_T CommitSize,
								__inout_opt PLARGE_INTEGER SectionOffset,
								__inout PSIZE_T ViewSize,
								__in SECTION_INHERIT InheritDisposition,
								__in ULONG AllocationType,
								__in WIN32_PROTECTION_MASK Win32Protect
								);

#endif
